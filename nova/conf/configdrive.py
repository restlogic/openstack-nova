from bees import profiler as p
from oslo_config import cfg
config_drive_opts = [cfg.StrOpt('config_drive_format', default='iso9660', deprecated_for_removal=True, deprecated_since='19.0.0', deprecated_reason='\nThis option was originally added as a workaround for bug in libvirt, #1246201,\nthat was resolved in libvirt v1.2.17. As a result, this option is no longer\nnecessary or useful.\n', choices=[('iso9660', 'A file system image standard that is widely supported across operating systems.'), ('vfat', 'Provided for legacy reasons and to enable live migration with the libvirt driver and non-shared storage')], help='\nConfig drive format.\n\nConfig drive format that will contain metadata attached to the instance when it\nboots.\n\nRelated options:\n\n* This option is meaningful when one of the following alternatives occur:\n\n  1. ``force_config_drive`` option set to ``true``\n  2. the REST API call to create the instance contains an enable flag for\n     config drive option\n  3. the image used to create the instance requires a config drive,\n     this is defined by ``img_config_drive`` property for that image.\n\n* A compute node running Hyper-V hypervisor can be configured to attach\n  config drive as a CD drive. To attach the config drive as a CD drive, set the\n  ``[hyperv] config_drive_cdrom`` option to true.\n'), cfg.BoolOpt('force_config_drive', default=False, help="\nForce injection to take place on a config drive\n\nWhen this option is set to true config drive functionality will be forced\nenabled by default, otherwise users can still enable config drives via the REST\nAPI or image metadata properties. Launched instances are not affected by this\noption.\n\nPossible values:\n\n* True: Force to use of config drive regardless the user's input in the\n        REST API call.\n* False: Do not force use of config drive. Config drives can still be\n         enabled via the REST API or image metadata properties.\n\nRelated options:\n\n* Use the 'mkisofs_cmd' flag to set the path where you install the\n  genisoimage program. If genisoimage is in same path as the\n  nova-compute service, you do not need to set this flag.\n* To use a config drive with Hyper-V, you must set the\n  'mkisofs_cmd' value to the full path to an mkisofs.exe installation.\n  Additionally, you must set the qemu_img_cmd value in the hyperv\n  configuration section to the full path to an qemu-img command\n  installation.\n"), cfg.StrOpt('mkisofs_cmd', default='genisoimage', help='\nName or path of the tool used for ISO image creation.\n\nUse the ``mkisofs_cmd`` flag to set the path where you install the\n``genisoimage`` program. If ``genisoimage`` is on the system path, you do not\nneed to change the default value.\n\nTo use a config drive with Hyper-V, you must set the ``mkisofs_cmd`` value to\nthe full path to an ``mkisofs.exe`` installation. Additionally, you must set\nthe ``qemu_img_cmd`` value in the hyperv configuration section to the full path\nto an ``qemu-img`` command installation.\n\nPossible values:\n\n* Name of the ISO image creator program, in case it is in the same directory\n  as the nova-compute service\n* Path to ISO image creator program\n\nRelated options:\n\n* This option is meaningful when config drives are enabled.\n* To use config drive with Hyper-V, you must set the ``qemu_img_cmd``\n  value in the hyperv configuration section to the full path to an ``qemu-img``\n  command installation.\n')]

@p.trace('register_opts')
def register_opts(conf):
    conf.register_opts(config_drive_opts)

@p.trace('list_opts')
def list_opts():
    return {'DEFAULT': config_drive_opts}